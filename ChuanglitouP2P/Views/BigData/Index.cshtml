
@{
    ViewBag.Title = "创利投 - 运营数据报告";

    Layout = "~/Views/Shared/Index_Layout.cshtml";
}
    <link href="~/Content/css.css" rel="stylesheet" />
    <script src="~/Scripts/jquery-1.9.1.min.js"></script>
    <script src="~/Scripts/jquery.flexslider.js"></script>
    <script src="~/Scripts/index.js"></script>
    <script src="~/Scripts/clock_time.js"></script>
    <script src="~/Scripts/countUp.js"></script>
    <style>
        .yunying_2main_bottom ul li span sub {
            color: #257be5;
            font-size: 24px;
            vertical-align: bottom;
        }
    </style>

    <div class="yunying">
        <div class="yunying_1">
            <img src="../images/bigData/yunying_bg1.jpg" class="yunying_1bg">
            <div class="yunying_1main">
                <h3>已安全运营 @ViewBag.Days 天</h3>
                <p class="time_txt1">数据统计截止时间 @ViewBag.ShowTime</p>
            </div>
        </div>
        <div class="yunying_2">
            <!-- <img src="images/yunying_bg2.jpg" class="yunying_2bg"> -->
            <div class="yunying_2main">
                <div class="yunying_2main_top">
                    <h3>数据总览</h3>
                    <p class="time_txt1">数据统计截止时间 @ViewBag.ShowTime</p>
                </div>
                <div class="yunying_2main_bottom">
                    <ul>
                        <li>
                            <img src="../images/bigData/yunying_1.png">
                            <small>累计为企业和个人融资</small>
                            <span id="allAmt" style="display:inline-block">88,888,888.88</span><span style="display:inline-block">&nbsp;元</span>
                        </li>
                        <li>
                            <img src="../images/bigData/yunying_2.png">
                            <small>累计为投资人赚取收益</small>
                            <span id="profitAmt" style="display:inline-block">888,888.88</span><span style="display:inline-block">&nbsp;元</span>
                        </li>
                        <li>
                            <img src="../images/bigData/yunying_3.png">
                            <small>累计投资笔数</small>
                            <span id="businessCount" style="display:inline-block">88,888</span><span style="display:inline-block">&nbsp;笔</span>
                        </li>
                        <li>
                            <img src="../images/bigData/yunying_4.png">
                            <small>平台注册人数</small>
                            <span id="registerCount" style="display:inline-block">88,888</span><span style="display:inline-block">&nbsp;人</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="yunying_3">
            <!-- <img src="images/yunying_bg3.jpg" class="yunying_3bg"> -->
            <div class="yunying_3main">
                <div class="yunying_3main_1" id="di1">
                    <div class="yunying_3main_1_top">
                        <h3><small>01</small>交易数据</h3>
                        <p class="time_txt">数据统计截止时间 @ViewBag.ShowTime</p>
                    </div>
                    <table cellpadding="0" cellspacing="0" border="0" class="yunying_3main_1_table" style="width:100%;">
                        <thead>
                            <tr>
                                <th width="20%">数据名称</th>
                                <th width="25%">数据</th>
                                <th width="55%">数据说明</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: #dce9ff;">
                                <td width="20%" style="text-align:center;">交易总额</td>
                                <td width="25%" style="text-align:center;">@ViewBag.PrincipalAmt 元</td>
                                <td width="55%">指自平台上线运营时起，所有实际撮合成功的融资项目的资金（本金）总额，实时更新；</td>
                            </tr>
                            <tr style="background: #e9f1ff;">
                                <td width="20%" style="text-align:center;">交易总笔数</td>
                                <td width="25%" style="text-align:center;">@ViewBag.BusinessCount 笔</td>
                                <td width="55%">指自平台上线运营时起，平台实际撮合成功的所有融资项目总笔数，实时更新；</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="yunying_3main_1" id="di2">
                    <div class="yunying_3main_1_top">
                        <h3><small>02</small>投资数据</h3>
                        <p class="time_txt">数据统计截止时间 @ViewBag.ShowTime</p>
                    </div>
                    <table cellpadding="0" cellspacing="0" border="0" class="yunying_3main_1_table" style="width:100%;">
                        <thead>
                            <tr>
                                <th width="20%">数据名称</th>
                                <th width="25%">数据</th>
                                <th width="55%">数据说明</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: #dce9ff;">
                                <td width="20%" style="text-align:center;">投资人总数</td>
                                
                                <td width="25%" style="text-align:center;">@ViewBag.TotalNumber 人</td>
                                <td width="55%">指自平台上线运营时起，平台实际撮合成功的融资项目中投资人总数，实时更新；</td>
                            </tr>
                            <tr style="background: #e9f1ff;">
                                <td width="20%" style="text-align:center;">总投资额</td>
                                <td width="25%" style="text-align:center;">@ViewBag.AllAmt 元</td>
                                <td width="55%">指自平台上线运营时起，所有实际撮合成功的融资项目的投资资金（本金）总额，实时更新；</td>
                            </tr>
                            <tr style="background: #dce9ff;">
                                <td width="20%" style="text-align:center;">人均投资额</td>
                                <td width="25%" style="text-align:center;">@ViewBag.AvgAmt 元</td>
                                <td width="55%">指自平台上线运营之日起，交易总额与投资人总数之比，实时更新；</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="yunying_3main_1" id="di3">
                    <div class="yunying_3main_1_top">
                        <h3><small>03</small>借款数据</h3>
                        <p class="time_txt">数据统计截止时间 @ViewBag.ShowTime</p>
                    </div>
                    <table cellpadding="0" cellspacing="0" border="0" class="yunying_3main_1_table" style="width:100%;">
                        <thead>
                            <tr>
                                <th width="20%">数据名称</th>
                                <th width="25%">数据</th>
                                <th width="55%">数据说明</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: #dce9ff;">
                                <td width="20%" style="text-align:center;">借款总数</td>
                                <td width="25%" style="text-align:center;">@ViewBag.LoanCompletedCount 次</td>
                                <td width="55%">指自平台上线运营时起，平台实际撮合成功的融资项目总数，实时更新；</td>
                            </tr>
                            <tr style="background: #e9f1ff;">
                                <td width="20%" style="text-align:center;">借款总额</td>
                                <td width="25%" style="text-align:center;">@ViewBag.LoanCompletedAmt 元</td>
                                <td width="55%">指自平台上线运营时起，所有实际撮合成功的融资项目的借款资金（本金）总额，实时更新；</td>
                            </tr>
                            <tr style="background: #dce9ff;">
                                <td width="20%" style="text-align:center;">待偿金额</td>
                                <td width="25%" style="text-align:center;">@ViewBag.CollectLoanCompletedAmt 元</td>
                                <td width="55%">指截至统计时点，平台所有融资人尚未偿还的本金总金额（不包括利息部分），实时更新；</td>
                            </tr>
                            <tr style="background: #e9f1ff;">
                                <td width="20%" style="text-align:center;">人均借款额</td>
                                <td width="25%" style="text-align:center;">@ViewBag.AvgLoanCompletedAmt 元</td>
                                <td width="55%">指自平台上线运营之日起，交易总额与借款人总数之比，实时更新；</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="yunying_3main_1" id="di4">
                    <div class="yunying_3main_1_top">
                        <h3><small>04</small>风控数据</h3>
                        <p class="time_txt">数据统计截止时间 @ViewBag.ShowTime</p>
                    </div>
                    <table cellpadding="0" cellspacing="0" border="0" class="yunying_3main_1_table" style="width:100%;">
                        <thead>
                            <tr>
                                <th width="20%">数据名称</th>
                                <th width="25%">数据</th>
                                <th width="55%">数据说明</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: #dce9ff;">
                                <td width="20%" style="text-align:center;">逾期金额</td>
                                <td width="25%" style="text-align:center;">0 元</td>
                                <td width="55%">指截至统计时点，所有逾期的且尚未偿还的本金金额总和，实时更新；</td>
                            </tr>
                            <tr style="background: #e9f1ff;">
                                <td width="20%" style="text-align:center;">项目逾期率</td>
                                <td width="25%" style="text-align:center;">0</td>
                                <td width="55%">指截至统计时点，当前所有处于逾期状态的项目数与尚未偿还交易总笔数之比，实时统计与更新；</td>
                            </tr>
                            <tr style="background: #dce9ff;">
                                <td width="20%" style="text-align:center;">金额逾期率</td>
                                <td width="25%" style="text-align:center;">0</td>
                                <td width="55%">指截至统计时点，逾期金额与待偿金额之比，实时统计与更新；</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="yunying_4">
            <!-- <img src="images/yunying_bg4.jpg" class="yunying_4bg"> -->
            <div class="yunying_4main">
                <div class="yunying_4main_top">
                    <h3>风险控制</h3>
                    <p class="time_txt">数据统计截止时间 @ViewBag.ShowTime</p>
                    <span>平台安全运营 @ViewBag.Days 天，用户本息0损失</span>
                </div>
                <div class="yunying_4main_bottom">
                    <div class="yunying_4main_bottom_left">
                        <h3>历史兑付率</h3>
                        <h1>100<span>%兑付</span></h1>
                    </div>
                    <div class="yunying_4main_bottom_right">
                        <h3>近三个月的逾期信息</h3>
                        <p><span>逾期项目数量：</span><sub>0 个</sub></p>
                        <p><span>累计逾期金额：</span><sub>0 元</sub></p>
                        <p><span>累计代偿金额：</span><sub>0 元</sub></p>
                        <p><span>借贷逾期率：</span><sub>0</sub></p>
                        <p><span>项目逾期率：</span><sub>0</sub></p>
                    </div>
                </div>
            </div>
        </div>
        <div class="yunying_fixed" style="display:none;">
            <ul>
                <li scTop="0" class="san"><span><sub>1</sub></span>交易数据</li>
                <li scTop="306"><span><sub>2</sub></span>投资数据</li>
                <li scTop="672"><span><sub>3</sub></span>借款数据</li>
                <li scTop="898"><span><sub>4</sub></span>风控数据</li>
            </ul>
        </div>
    </div>
    <script type="text/javascript">
        var _defaultData;
        var _isSuccess = true;
        var countUpFlag = 0;
        function defaultAjax(url, data, callback) {
            $.ajax({
                url: url,
                type: 'POST',
                data: data,
                async: false,
                error: function () {
                    _isSuccess = false;
                },
                success: defaultCallback
            });
        }
        function defaultCallback(data) {
            _defaultData = data;
        }
        function formatCurrency(num) {
            num = num.toString().replace(/\$|\,/g, '');
            if (isNaN(num))
                num = "0";
            sign = (num == (num = Math.abs(num)));
            num = Math.floor(num * 100 + 0.50000000001);
            cents = num % 100;
            num = Math.floor(num / 100).toString();
            if (cents < 10)
                cents = "0" + cents;
            for (var i = 0; i < Math.floor((num.length - (1 + i)) / 3) ; i++)
                num = num.substring(0, num.length - (4 * i + 3)) + ',' +
                num.substring(num.length - (4 * i + 3));
            return (((sign) ? '' : '-') + num + '.' + cents);
        }


        function getTotal() {
            var url = "/BigData/GetTotal";
            var data = {};
            _defaultData = null;
            defaultAjax(url, data, defaultCallback);
            if (_defaultData != null && _defaultData.state == 0) {
                $("#allAmt").html(formatCurrency(_defaultData.allAmt));
                $("#profitAmt").html(formatCurrency(_defaultData.profitAmt));
                $("#businessCount").html(formatCurrency(_defaultData.businessCount).split('.')[0]);
                $("#registerCount").html(formatCurrency(_defaultData.registerCount).split('.')[0]);
                $(".time_txt1").html("数据统计截止时间" + _defaultData.time);
                if (countUpFlag == 0) {
                    $("#allAmt").attr("data-spark", _defaultData.allAmt);
                    $("#profitAmt").attr("data-spark", _defaultData.profitAmt);
                    $("#businessCount").attr("data-spark", _defaultData.businessCount);
                    $("#registerCount").attr("data-spark", _defaultData.registerCount);
                    
                    var options = {
                        useEasing: true,
                        useGrouping: true,
                        separator: ',',
                        decimal: '.',
                        prefix: '',
                        suffix: ''
                    };
                    var allAmt = new CountUp("allAmt", 0, $("#allAmt").data("spark"), 2, 1, options);
                    var profitAmt = new CountUp("profitAmt", 0, $("#profitAmt").data("spark"), 2, 1, options);
                    var businessCount = new CountUp("businessCount", 0, $("#businessCount").data("spark"), 0, 1, options);
                    var registerCount = new CountUp("registerCount", 0, $("#registerCount").data("spark"),0, 1, options);
                    allAmt.start();
                    profitAmt.start();
                    businessCount.start();
                    registerCount.start();
                    countUpFlag++;
                }
            }
        }
        $(function () {
            $('html, body').animate({ scrollTop: 220 }, 'slow');
            getTotal();
            setInterval("getTotal()", 1000*60);
        });
        $(function () {
            var offsetTop = $(window).height() / 3.5;
            var diTop1 = $("#di1").offset().top - offsetTop;
            var diTop2 = $("#di2").offset().top - offsetTop;
            var diTop3 = $("#di3").offset().top - offsetTop;
            var diTop4 = $("#di4").offset().top - offsetTop;
            $(".yunying_fixed>ul li").eq(0).attr("scTop", diTop1 + 10);
            $(".yunying_fixed>ul li").eq(1).attr("scTop", diTop2 + 10);
            $(".yunying_fixed>ul li").eq(2).attr("scTop", diTop3 + 10);
            $(".yunying_fixed>ul li").eq(3).attr("scTop", diTop4 + 10);
            $(window).scroll(function () {
                var scrollTopT = $(this).scrollTop();
                if (scrollTopT >= 700) {
                    $(".yunying_fixed").show();
                } else {
                    $(".yunying_fixed").hide();
                }
                if (scrollTopT >= diTop1) {
                    $(".yunying_fixed>ul li").eq(0).addClass("san").siblings().removeClass("san");
                }
                if (scrollTopT >= diTop2) {
                    $(".yunying_fixed>ul li").eq(1).addClass("san").siblings().removeClass("san");
                }
                if (scrollTopT >= diTop3) {
                    $(".yunying_fixed>ul li").eq(2).addClass("san").siblings().removeClass("san");
                }
                if (scrollTopT >= diTop4) {
                    $(".yunying_fixed>ul li").eq(3).addClass("san").siblings().removeClass("san");
                }
            })

            $(".yunying_fixed ul li").click(function () {
                $(this).addClass("san").siblings().removeClass("san");
                var sTop = $(this).attr("scTop");
                window.scroll(0, sTop);
            })
        });
    </script>